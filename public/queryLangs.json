{
    "KQLtables": [
        {
            "TableName": "SecurityEvent",
            "Purpose": "Stores Windows event log data from devices and servers. Commonly used for security-related logs such as logins, account management, and system auditing.",
            "KeyScenarios": ["Brute force detection", "Unauthorized access monitoring"],
            "Fields": ["EventID", "TimeGenerated", "Computer", "AccountName", "AccountDomain", "LogonType", "EventLevel", "Source"]
        },
        {
            "TableName": "SecurityAlert",
            "Purpose": "Contains data on security alerts generated by Azure Security Center, Microsoft Defender, and other integrated tools.",
            "KeyScenarios": ["Tracking and triaging alerts"],
            "Fields": ["TimeGenerated", "AlertName", "Severity", "Entity", "Description", "ProviderName", "Status"]
        },
        {
            "TableName": "SecurityIncident",
            "Purpose": "Tracks incidents, which are collections of related alerts.",
            "KeyScenarios": ["Incident response and analysis"],
            "Fields": ["IncidentNumber", "Title", "Severity", "Status", "Owner", "LastModifiedTime", "RelatedAlerts"]
        },
        {
            "TableName": "AzureDiagnostics",
            "Purpose": "Stores diagnostic logs from various Azure services like Application Gateway, Key Vault, or Azure Firewall.",
            "KeyScenarios": ["Monitoring Azure infrastructure for anomalies"],
            "Fields": ["ResourceId", "OperationName", "Category", "ResultType", "CallerIpAddress", "Message", "TimeGenerated"]
        },
        {
            "TableName": "AuditLogs",
            "Purpose": "Contains logs from Azure Active Directory (AAD) related to configuration changes and administrative activities.",
            "KeyScenarios": ["Monitoring privileged actions in Azure AD"],
            "Fields": ["Activity", "InitiatedBy", "Result", "Category", "CorrelationId", "TimeGenerated"]
        },
        {
            "TableName": "SignInLogs",
            "Purpose": "Stores user sign-in activity from Azure AD.",
            "KeyScenarios": ["Identifying suspicious sign-in behavior", "MFA bypass attempts"],
            "Fields": ["UserPrincipalName", "IPAddress", "Location", "ResultType", "AppDisplayName", "TimeGenerated"]
        },
        {
            "TableName": "OfficeActivity",
            "Purpose": "Contains Office 365 audit logs for activities such as file access, mailbox operations, and SharePoint activity.",
            "KeyScenarios": ["Tracking user activity in Office 365 applications"],
            "Fields": ["Operation", "UserId", "Workload", "ItemName", "ResultStatus", "TimeGenerated"]
        },
        {
            "TableName": "AADRiskyUsers",
            "Purpose": "Provides information on risky users detected by Azure AD Identity Protection.",
            "KeyScenarios": ["Identifying and mitigating account compromises"],
            "Fields": ["UserPrincipalName", "RiskLevel", "RiskState", "RiskDetail", "TimeGenerated"]
        },
        {
            "TableName": "AADRiskySignIns",
            "Purpose": "Provides information on risky sign-ins detected by Azure AD Identity Protection.",
            "KeyScenarios": ["Identifying and mitigating account compromises"],
            "Fields": ["UserPrincipalName", "IPAddress", "RiskLevel", "RiskState", "CorrelationId", "TimeGenerated"]
        },
        {
            "TableName": "Heartbeat",
            "Purpose": "Tracks the health and connectivity of connected agents.",
            "KeyScenarios": ["Monitoring system availability"],
            "Fields": ["Computer", "Category", "TimeGenerated", "OSName", "IPAddress"]
        },
        {
            "TableName": "AzureNetworkAnalytics_CL",
            "Purpose": "Stores logs related to Azure networking, such as traffic flow and Network Security Group (NSG) events.",
            "KeyScenarios": ["Analyzing network traffic for anomalies"],
            "Fields": ["TimeGenerated", "SourceIP", "DestinationIP", "SourcePort", "DestinationPort", "Action", "Protocol"]
        },
        {
            "TableName": "DnsEvents",
            "Purpose": "Logs DNS query data from endpoints or servers.",
            "KeyScenarios": ["Detecting command-and-control (C2) communications"],
            "Fields": ["QueryName", "QueryType", "TimeGenerated", "ClientIP", "ServerIP"]
        },
        {
            "TableName": "AzureFirewall",
            "Purpose": "Stores logs from Azure Firewall, including allowed and denied traffic.",
            "KeyScenarios": ["Investigating network intrusions or misconfigurations"],
            "Fields": ["SourceIP", "DestinationIP", "SourcePort", "DestinationPort", "Action", "Protocol", "TimeGenerated"]
        },
        {
            "TableName": "DeviceEvents",
            "Purpose": "Logs endpoint data from Microsoft Defender for Endpoint.",
            "KeyScenarios": ["Monitoring endpoint activity for malicious behavior"],
            "Fields": ["DeviceName", "EventTime", "EventName", "AccountName", "IPAddress", "ThreatName"]
        },
        {
            "TableName": "DeviceNetworkEvents",
            "Purpose": "Captures network traffic metadata from endpoints.",
            "KeyScenarios": ["Detecting lateral movement or unusual outbound traffic"],
            "Fields": ["DeviceName", "SourceIP", "DestinationIP", "SourcePort", "DestinationPort", "Protocol", "TimeGenerated"]
        },
        {
            "TableName": "ThreatIntelligenceIndicator",
            "Purpose": "Stores threat intelligence feeds and indicators of compromise (IOCs).",
            "KeyScenarios": ["Enrichment of hunting queries with threat intelligence"],
            "Fields": ["IndicatorType", "IndicatorValue", "ThreatType", "Description", "LastUpdatedTime"]
        },
        {
            "TableName": "MalwareAssessmentEvents",
            "Purpose": "Logs malware events detected on endpoints.",
            "KeyScenarios": ["Investigating malware incidents"],
            "Fields": ["DeviceName", "MalwareName", "Severity", "ActionTaken", "DetectionSource", "TimeGenerated"]
        },
        {
            "TableName": "Syslog",
            "Purpose": "Stores syslog data from Linux/Unix devices or other systems supporting syslog forwarding.",
            "KeyScenarios": ["Monitoring and investigating activity on Linux servers"],
            "Fields": ["Host", "Facility", "Severity", "Message", "TimeGenerated"]
        },
        {
            "TableName": "CommonSecurityLog",
            "Purpose": "Generic log for security appliances like firewalls, IDS/IPS, and VPNs.",
            "KeyScenarios": ["Aggregated monitoring for non-Azure devices"],
            "Fields": ["SourceIP", "DestinationIP", "Action", "DeviceType", "Severity", "TimeGenerated"]
        },
        {
            "TableName": "CustomLogs",
            "Purpose": "Allows ingestion of custom log files.",
            "KeyScenarios": ["Custom data sources or unsupported log formats"],
            "Fields": ["LogFileName", "Message", "TimeGenerated", "CustomField1", "CustomField2"]
        },
        {
            "TableName": "Perf",
            "Purpose": "Logs performance data for monitored devices.",
            "KeyScenarios": ["Identifying performance bottlenecks or resource usage anomalies"],
            "Fields": ["Computer", "ObjectName", "CounterName", "CounterValue", "TimeGenerated"]
        },
        {
            "TableName": "Event",
            "Purpose": "Contains all types of events from connected devices.",
            "KeyScenarios": ["General hunting and query building"],
            "Fields": ["EventID", "TimeGenerated", "Computer", "EventLevel", "Message"]
        },
        {
            "TableName": "Alerts",
            "Purpose": "Consolidated alert data across different tools.",
            "KeyScenarios": ["Multi-source alert analysis"],
            "Fields": ["AlertName", "Severity", "Status", "Source", "TimeGenerated", "Entity"]
        },
        {
            "TableName": "Usage",
            "Purpose": "Provides information about the usage and costs of the Log Analytics workspace.",
            "KeyScenarios": ["Monitoring workspace health and cost management"],
            "Fields": ["TimeGenerated", "Solution", "DataUsage", "ResourceName", "SubscriptionId"]
        }
    ],
    "SplunkLogSources": [
        {
            "SourceType": "WinEventLog",
            "Purpose": "Ingests Windows Event Logs, including Application, Security, and System events.",
            "KeyScenarios": ["Monitoring login events", "Account management activity", "System errors"],
            "Fields": ["EventCode", "EventType", "ComputerName", "User", "Message", "LogName", "SourceName", "RecordNumber"]
        },
        {
            "SourceType": "Syslog",
            "Purpose": "Ingests logs from Unix/Linux systems, firewalls, routers, and other devices supporting syslog.",
            "KeyScenarios": ["System auditing", "Network device monitoring"],
            "Fields": ["host", "source", "sourcetype", "severity", "timestamp", "facility", "message"]
        },
        {
            "SourceType": "Stream",
            "Purpose": "Captures network packet data, providing deep insight into network traffic.",
            "KeyScenarios": ["Analyzing network anomalies", "Identifying data exfiltration"],
            "Fields": ["src_ip", "dst_ip", "src_port", "dst_port", "protocol", "bytes_in", "bytes_out", "timestamp"]
        },
        {
            "SourceType": "DBConnect",
            "Purpose": "Ingests logs and data from databases.",
            "KeyScenarios": ["Monitoring database queries", "Detecting unauthorized database access"],
            "Fields": ["query", "query_time", "database_name", "username", "host", "rows_returned"]
        },
        {
            "SourceType": "CloudWatch",
            "Purpose": "Integrates with AWS CloudWatch for collecting logs from AWS services.",
            "KeyScenarios": ["AWS service usage monitoring", "Security monitoring in AWS"],
            "Fields": ["logGroup", "logStream", "message", "eventId", "timestamp", "source", "resource"]
        },
        {
            "SourceType": "S3",
            "Purpose": "Ingests logs stored in Amazon S3 buckets, such as CloudTrail logs.",
            "KeyScenarios": ["CloudTrail auditing", "Storage access monitoring"],
            "Fields": ["bucket_name", "file_path", "event_time", "event_name", "principalId", "sourceIPAddress"]
        },
        {
            "SourceType": "HttpEventCollector (HEC)",
            "Purpose": "Enables applications to send data directly to Splunk over HTTP/HTTPS.",
            "KeyScenarios": ["Custom application monitoring", "Real-time data ingestion"],
            "Fields": ["event", "host", "source", "sourcetype", "fields"]
        },
        {
            "SourceType": "Active Directory",
            "Purpose": "Collects logs from Active Directory to monitor user and group activity.",
            "KeyScenarios": ["Monitoring privileged account activity", "Detecting Active Directory misconfigurations"],
            "Fields": ["EventID", "AccountName", "AccountDomain", "LogonType", "SourceWorkstation", "TargetUser"]
        },
        {
            "SourceType": "Palo Alto Networks",
            "Purpose": "Ingests logs from Palo Alto firewalls, including traffic, threat, and configuration logs.",
            "KeyScenarios": ["Firewall traffic analysis", "Intrusion detection"],
            "Fields": ["SourceIP", "DestinationIP", "SourcePort", "DestinationPort", "ThreatName", "Action", "Application"]
        },
        {
            "SourceType": "Cisco ASA",
            "Purpose": "Collects logs from Cisco Adaptive Security Appliance (ASA) devices.",
            "KeyScenarios": ["VPN activity monitoring", "Firewall log analysis"],
            "Fields": ["src_ip", "dst_ip", "src_port", "dst_port", "protocol", "action", "reason", "timestamp"]
        }
    ],
    "ElasticLogSources": [
        {
            "SourceType": "Filebeat",
            "Purpose": "Collects and forwards log data from files, including application logs, audit logs, and system logs.",
            "KeyScenarios": ["Log file monitoring", "Forwarding web server logs"],
            "Fields": ["log.file.path", "message", "timestamp", "host.name", "event.dataset", "log.offset"]
        },
        {
            "SourceType": "Metricbeat",
            "Purpose": "Collects metrics from operating systems and services, such as CPU usage and memory stats.",
            "KeyScenarios": ["System performance monitoring", "Resource usage analysis"],
            "Fields": ["system.cpu.total.pct", "system.memory.used.bytes", "system.load.1", "host.name", "timestamp"]
        },
        {
            "SourceType": "Packetbeat",
            "Purpose": "Captures network traffic and provides data on protocols like HTTP, DNS, and MySQL.",
            "KeyScenarios": ["Network monitoring", "Troubleshooting application performance"],
            "Fields": ["source.ip", "destination.ip", "source.port", "destination.port", "protocol", "bytes_in", "bytes_out", "timestamp"]
        },
        {
            "SourceType": "Winlogbeat",
            "Purpose": "Collects Windows Event Logs and forwards them to Elasticsearch.",
            "KeyScenarios": ["Windows system monitoring", "Security event analysis"],
            "Fields": ["event.code", "event.provider", "host.name", "user.name", "log.level", "message", "timestamp"]
        },
        {
            "SourceType": "Auditbeat",
            "Purpose": "Monitors audit frameworks for security-related events, such as file changes and login attempts.",
            "KeyScenarios": ["File integrity monitoring", "User activity auditing"],
            "Fields": ["auditd.log.record_type", "auditd.log.action", "user.name", "file.path", "host.name", "timestamp"]
        },
        {
            "SourceType": "Logstash",
            "Purpose": "Processes and transforms log data before sending it to Elasticsearch.",
            "KeyScenarios": ["Data enrichment", "Custom log transformation"],
            "Fields": ["tags", "message", "host", "event_id", "processed_fields"]
        },
        {
            "SourceType": "Elasticsearch Ingest API",
            "Purpose": "Directly ingests data into Elasticsearch using API calls.",
            "KeyScenarios": ["Custom integrations", "Real-time data ingestion"],
            "Fields": ["_index", "_type", "_id", "_source", "timestamp"]
        },
        {
            "SourceType": "Cloudflare Logs",
            "Purpose": "Collects data from Cloudflare services, such as HTTP access logs and threat logs.",
            "KeyScenarios": ["Web traffic analysis", "DDoS detection"],
            "Fields": ["client.ip", "http.host", "http.method", "http.response.status", "threat.name", "timestamp"]
        },
        {
            "SourceType": "Kubernetes Logs",
            "Purpose": "Ingests logs from Kubernetes clusters and applications.",
            "KeyScenarios": ["Container monitoring", "Application performance monitoring"],
            "Fields": ["kubernetes.namespace", "kubernetes.pod.name", "container.id", "log", "timestamp"]
        },
        {
            "SourceType": "AWS CloudWatch Logs",
            "Purpose": "Collects logs from AWS services through CloudWatch.",
            "KeyScenarios": ["AWS security monitoring", "Resource utilization tracking"],
            "Fields": ["logGroup", "logStream", "message", "timestamp", "source", "awsRegion"]
        }
  ]
}
