<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Query Generator</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Query Generator</h1>
        </header>

        <main>
            <div class="query-builder">
                <!-- Query Language Selection -->
                <section class="section">
                    <h2>Query Language</h2>
                    <div class="language-selector">
                        <select id="queryLanguage">
                            <option value="spl">Splunk (SPL)</option>
                            <option value="eql">Elastic (EQL)</option>
                            <option value="kql">Kusto (KQL)</option>
                        </select>
                    </div>
                </section>

                <!-- MITRE ATT&CK Framework -->
                <section class="section">
                    <h2>MITRE ATT&CK Tactic</h2>
                    <select id="mitreTactic">
                        <option value="">Select a tactic...</option>
                        <option value="initial-access">Initial Access</option>
                        <option value="execution">Execution</option>
                        <option value="persistence">Persistence</option>
                        <option value="privilege-escalation">Privilege Escalation</option>
                        <option value="defense-evasion">Defense Evasion</option>
                        <option value="credential-access">Credential Access</option>
                        <option value="discovery">Discovery</option>
                        <option value="lateral-movement">Lateral Movement</option>
                        <option value="collection">Collection</option>
                        <option value="command-control">Command and Control</option>
                        <option value="exfiltration">Exfiltration</option>
                        <option value="impact">Impact</option>
                    </select>
                </section>

                <!-- Log Sources -->
                <section class="section">
                    <h2>Log Sources</h2>
                    <div class="log-sources">
                        <!-- Log sources will be dynamically populated -->
                    </div>
                    <button id="addCustomLog">Add Custom Log Source</button>
                </section>

                <!-- Query Parameters -->
                <section class="section">
                    <h2>Query Parameters</h2>
                    <div class="parameters">
                        <!-- Parameter rows will be added here -->
                    </div>
                    <button id="addParameter">Add Parameter</button>
                </section>

                <!-- Time Range -->
                <section class="section">
                    <h2>Time Range</h2>
                    <select id="timeRange">
                        <option value="15m">Last 15 minutes</option>
                        <option value="1h">Last hour</option>
                        <option value="24h">Last 24 hours</option>
                        <option value="7d">Last 7 days</option>
                        <option value="30d">Last 30 days</option>
                        <option value="custom">Custom range</option>
                    </select>
                    <div id="customTimeRange" style="display: none;">
                        <input type="datetime-local" id="startTime">
                        <input type="datetime-local" id="endTime">
                    </div>
                </section>

                <!-- Query Templates -->
                <section class="section">
                    <h2>Query Templates</h2>
                    <select id="queryTemplate">
                        <option value="">Select a template...</option>
                        <option value="privilege-escalation">Privilege Escalation</option>
                        <option value="suspicious-login">Suspicious Login Activity</option>
                        <option value="data-exfil">Data Exfiltration</option>
                        <option value="lateral-movement">Lateral Movement</option>
                        <option value="ransomware-activity">Ransomware Activity</option>
                        <option value="unusual-process-execution">Unusual Process Execution</option>
                        <option value="dns-tunneling">DNS Tunneling</option>
                        <option value="malicious-powershell">Malicious PowerShell Execution</option>
                        <option value="unauthorized-access">Unauthorized File Access</option>
                        <option value="phishing-detection">Phishing Email Detection</option>
                    </select>
                </section>

                <!-- Template Documentation -->
                <section class="section">
                    <h2>Template Documentation</h2>
                    <div id="queryExplanation">
                        <!-- Template documentation will be displayed here -->
                    </div>
                </section>

                <!-- Generated Query -->
                <section class="section">
                    <h2>Generated Query</h2>
                    <div class="query-output">
                        <pre><code id="queryOutput">// Generated query will appear here</code></pre>
                    </div>
                    <div class="query-actions">
                        <button id="copyQuery">Copy Query</button>
                        <button id="downloadQuery">Download Query</button>
                        <button id="validateQuery">Validate Syntax</button>
                    </div>
                </section>

                <!-- Query Optimization -->
                <section class="section">
                    <h2>Query Optimization</h2>
                    <div id="optimizationSuggestions" class="suggestions">
                        <!-- Optimization suggestions will be displayed here -->
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script type="module" src="/app.js"></script>
</body>
</html>
